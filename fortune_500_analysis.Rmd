---
title: "final_planning"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# How did the rise in technology usage (social media, internet, etc..) aid or hurt historically successful businesses/industries? 


Loading Packages/Some Datasets
```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(forcats)
library(lubridate)
library(sparklyr)
library(ggthemes)
library(gridExtra)
setwd("~/OneDrive - University of Virginia/UVA/Spring 2022/SYS 2202/rstudio/SYS2202/FinalProject")
fortune_1000 <- read_csv("data_sources/Fortune_1000.csv") # provides sector info for selection of fortune 500 companies
fortune1995_2021 <- read_csv("data_sources/fortune500_1955_2021.csv")  # rank + revenue data for fortune 500 companies
internet_indicators_data <- read_csv("data_sources/data_internet_plus_indicators/56437442-eef4-42c7-ba08-45ad275860fb_data.csv") 
business_indicators_data <- read_csv("data_sources/data_business_indicators/aee336d2-021b-4021-912c-3de7fd9d2729_data.csv")

technology_adoption_by_households_in_the_united_states <- read_csv("data_sources/technology-adoption-by-households-in-the-united-states.csv")

computing_efficiency <- read_csv("data_sources/computing-efficiency.csv")
price_changes_in_consumer_goods_and_services_in_the_usa_1997_2017 <- read_csv("data_sources/price-changes-in-consumer-goods-and-services-in-the-usa-1997-2017.csv")

```
Prepare Fortune 1000 and Fortune1995_2021 for joining + join by company
```{r}
fortune_facts <- fortune_1000 %>%
  mutate(Company = company)
fortune_all <- fortune1995_2021 %>%
  mutate(Company = Name)

fortune_joined <- fortune_all %>%
  left_join(fortune_facts, by = "Company") %>%
  drop_na(sector)
# drop irrelavent columns
fortune_joined <- fortune_joined %>% 
  select(-c(rank, rank_change, revenue, profit, `num. of employees`, profitable, prev_rank, `Market Cap`))
```

Display rough distribution of sectors over the years
```{r}

fortune_joined %>%
  group_by(Year, sector) %>%
  filter(Rank < 20) %>%
  filter(Year > 1990) %>%
  ggplot(aes(Year)) +
  geom_bar(aes(fill = sector)) + 
  labs(title = "Sectors of Top companies on Fortune 500 since 1990")
           

fortune_joined %>%
  group_by(Year, sector) %>%
  ggplot(aes(Year)) +
  geom_bar(aes(fill = sector)) +
  labs(title = "Successful Businesses Sector Distribution Over the Years")

technology_adoption_by_households_in_the_united_states %>% 
  group_by(Year) %>% 
  ggplot(aes(Year, `Technology Diffusion (Comin and Hobijn (2004) and others)`)) +
  geom_col()


computing_efficiency %>%
  group_by(Year) %>%
  ggplot(aes(Year, log10(`Computing efficiency`))) +
  geom_line() +
  labs(title = "Computing efficiency, 1971 to 2015", 
       subtitle = "Computer processing efficiency, measured as the number of watts needed per million instructions per second - Watts per MIPS.") + 
  ylab("Computing Efficiency")
```

## Variable Breakdown (tentative)

Independent Variables:
- Internet Usage from 1990-2019
- Tech adoption by household 
- social network usage/reach among fortune 500 ceos (2012 - 2016)
- Broadband usage by household
- Sector (selecting by sector)

Dependent Variables:
- Sector, Revenue, Rank, -> used to indicate relative "success" of a company over the years







